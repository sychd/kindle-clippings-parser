import{a as M,t as O}from"../chunks/disclose-version.CrR-TKU6.js";import{i as G}from"../chunks/legacy.BnUwaaKB.js";import{A as T,B as K,C as J,D as Q,E as W,F as q,z as ee,G as j,H as te,I as $,J as H,K as I,L as le,M as N,N as P,O as X,P as ae,v as B,Q as ne,R as ie,S as re,T as se,U as oe,t as fe,V as ce,W as z,X as ue,Y as de,Z as pe,_ as ve,p as he,a as me,c as F,s as R,r as C,$ as xe,a0 as be,h as V}from"../chunks/runtime.--pst0dt.js";import{s as ge,i as _e,a as ye,b as we}from"../chunks/store.C6eP4Z0j.js";import{e as S}from"../chunks/events.BxObk9sV.js";import{w as ke}from"../chunks/index.sqQMIU6m.js";function Ee(o,e){return e}function Ae(o,e,t,f){for(var p=[],s=e.length,i=0;i<s;i++)ie(e[i].e,p,!0);var m=s>0&&p.length===0&&t!==null;if(m){var v=t.parentNode;re(v),v.append(t),f.clear(),k(o,e[0].prev,e[s-1].next)}se(p,()=>{for(var u=0;u<s;u++){var h=e[u];m||(f.delete(h.k),k(o,h.prev,h.next)),oe(h.e,!m)}})}function Ce(o,e,t,f,p,s=null){var i=o,m={flags:e,items:new Map,first:null};{var v=o;i=T?K(J(v)):v.appendChild(Q())}T&&W();var u=null,h=!1;q(()=>{var a=t(),d=ee(a)?a:a==null?[]:j(a),n=d.length;if(h&&n===0)return;h=n===0;let r=!1;if(T){var b=i.data===te;b!==(n===0)&&(i=$(),K(i),H(!1),r=!0)}if(T){for(var w=null,g,l=0;l<n;l++){if(I.nodeType===8&&I.data===le){i=I,r=!0,H(!1);break}var c=d[l],y=f(c,l);g=Z(I,m,w,null,c,y,l,p,e),m.items.set(y,g),w=g}n>0&&K($())}if(!T){var x=fe;Te(d,m,i,p,e,(x.f&N)!==0,f)}s!==null&&(n===0?u?P(u):u=X(()=>s(i)):u!==null&&ae(u,()=>{u=null})),r&&H(!0),t()}),T&&(i=I)}function Te(o,e,t,f,p,s,i,m){var v=o.length,u=e.items,h=e.first,a=h,d,n=null,r=[],b=[],w,g,l,c;for(c=0;c<v;c+=1){if(w=o[c],g=i(w,c),l=u.get(g),l===void 0){var y=a?a.e.nodes_start:t;n=Z(y,e,n,n===null?e.first:n.next,w,g,c,f,p),u.set(g,n),r=[],b=[],a=n.next;continue}if(Fe(l,w,c),l.e.f&N&&P(l.e),l!==a){if(d!==void 0&&d.has(l)){if(r.length<b.length){var x=b[0],_;n=x.prev;var D=r[0],E=r[r.length-1];for(_=0;_<r.length;_+=1)Y(r[_],x,t);for(_=0;_<b.length;_+=1)d.delete(b[_]);k(e,D.prev,E.next),k(e,n,D),k(e,E,x),a=x,n=E,c-=1,r=[],b=[]}else d.delete(l),Y(l,a,t),k(e,l.prev,l.next),k(e,l,n===null?e.first:n.next),k(e,n,l),n=l;continue}for(r=[],b=[];a!==null&&a.k!==g;)(s||!(a.e.f&N))&&(d??(d=new Set)).add(a),b.push(a),a=a.next;if(a===null)continue;l=a}r.push(l),n=l,a=l.next}if(a!==null||d!==void 0){for(var A=d===void 0?[]:j(d);a!==null;)(s||!(a.e.f&N))&&A.push(a),a=a.next;var U=A.length;if(U>0){var L=v===0?t:null;Ae(e,A,L,u)}}B.first=e.first&&e.first.e,B.last=n&&n.e}function Fe(o,e,t,f){ne(o.v,e),o.i=t}function Z(o,e,t,f,p,s,i,m,v,u){var h=(v&de)!==0,a=(v&pe)===0,d=h?a?ce(p):z(p):p,n=v&ue?z(i):i,r={i:n,v:d,k:s,a:null,e:null,prev:t,next:f};try{return r.e=X(()=>m(o,d,n),T),r.e.prev=t&&t.e,r.e.next=f&&f.e,t===null?e.first=r:(t.next=r,t.e.next=r.e),f!==null&&(f.prev=r,f.e.prev=r.e),r}finally{}}function Y(o,e,t){for(var f=o.next?o.next.e.nodes_start:t,p=e?e.e.nodes_start:t,s=o.e.nodes_start;s!==f;){var i=ve(s);p.before(s),s=i}}function k(o,e,t){e===null?o.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Re(o){var p;const e=o.split("==========").map(s=>s.trim()).filter(Boolean),t={};for(const s of e){const i=s.split(`
`).map(n=>n.trim()).filter(Boolean);if(i.length<3)continue;const[m,,...v]=i,[u,h]=((p=m.match(/^(.*) \((.*)\)$/))==null?void 0:p.slice(1))||[m,"Unknown"],a=v.join(" "),d=u.replace(/_/g," ");t[d]||(t[d]={title:d,author:h,clippings:[]}),t[d].clippings.push(a)}const f={};for(const s of Object.values(t)){const{title:i,author:m,clippings:v}=s,u=[`# ${i}`,`**Author:** ${m}`,"",...v.map(h=>`- ${h}`)].join(`
`);f[`${i.replace(/[^a-zA-Z0-9а-яА-Я]/g,"_")}.md`]=u}return f}var Ie=O('<li class="flex items-center justify-between rounded-lg bg-gray-100 p-2 shadow"><span class="truncate"> </span> <button class="text-blue-600 hover:underline">Download</button></li>'),De=O('<ul class="space-y-2"></ul>'),Me=O('<p class="text-gray-500">No files parsed yet.</p>'),Ne=O('<main class="flex min-h-screen flex-col items-center bg-gray-50 p-4"><div class="flex max-w-[860px] flex-1 flex-col items-center"><section class="max-w-xl py-8"><div class="mx-auto max-w-3xl"><h2 class="mb-6 text-center text-3xl font-semibold text-gray-800">Kindle Notes to Markdown Converter</h2> <p class="mb-4 text-lg text-gray-600">Convert your Kindle highlights and notes into an organized Markdown file with ease. Simply\n					upload your `.txt` file containing your Kindle excerpts, and the tool will:</p> <ul class=" list-inside list-disc text-lg text-gray-700"><li>Extract the book title, author, and timestamps from each entry.</li> <li>Organize the notes by book, with a header for each title.</li> <li>Display the first and last highlight dates for each book.</li> <li>List all your Kindle highlights and notes in order.</li></ul></div></section> <div class="w-full max-w-xl rounded-lg bg-white p-4 shadow-lg"><label for="file-upload" class="mb-2 block text-sm font-medium text-gray-700">Upload Kindle "My Clippings.txt" file(s)</label> <input type="file" id="file-upload" multiple accept=".txt" class="border-secondary-500 text-surface file:text-surface focus:border-primary focus:shadow-inset relative m-0 block w-full min-w-0 flex-auto cursor-pointer rounded-lg border border-solid bg-transparent bg-clip-padding px-3 py-1 text-sm font-normal transition duration-300 ease-in-out file:-mx-3 file:-my-[0.32rem] file:me-3 file:cursor-pointer file:overflow-hidden file:rounded-none file:border-0 file:border-e file:border-solid file:border-inherit file:bg-blue-600 file:px-3 file:py-[0.32rem] file:text-white file:hover:bg-blue-700 focus:text-gray-700 focus:outline-none dark:border-white/70 dark:text-white file:dark:text-white"> <button class="mt-4 w-full rounded-lg bg-blue-600 py-1 text-white hover:bg-blue-700">Parse Files</button></div> <div class="mt-8 w-full max-w-xl flex-1"><h2 class="mb-4 text-xl font-bold">Downloaded Files</h2> <!></div> <div class="mt-8 flex w-full max-w-md items-center justify-center text-sm">Created by &nbsp;<a class="text-blue-600 hover:text-blue-700" href="https://chillyhill.me/">Denys Sych</a></div></div></main>');function $e(o,e){he(e,!1);const t=ge(),f=()=>ye(s,"$parsedFiles",t);let p=[];const s=ke({});function i(l){const c=l.target;c.files&&(p=Array.from(c.files))}async function m(){for(const l of p){const c=await l.text(),y=Re(c);s.set(y)}}function v(l,c){const y=new Blob([c],{type:"text/markdown"}),x=document.createElement("a");x.href=URL.createObjectURL(y),x.download=l,x.click(),URL.revokeObjectURL(x.href)}G();var u=Ne(),h=F(u),a=R(F(h),2),d=R(F(a),2),n=R(d,2);C(a);var r=R(a,2),b=R(F(r),2);{var w=l=>{var c=De();Ce(c,5,()=>Object.entries(f()),Ee,(y,x)=>{let _=()=>V(x)[0],D=()=>V(x)[1];var E=Ie(),A=F(E),U=F(A,!0);C(A);var L=R(A,2);C(E),be(()=>we(U,_())),S("click",L,()=>v(_(),D())),M(y,E)}),C(c),M(l,c)},g=l=>{var c=Me();M(l,c)};_e(b,l=>{f()&&Object.keys(f()).length>0?l(w):l(g,!1)})}C(r),xe(2),C(h),C(u),S("change",d,i),S("click",n,m),M(o,u),me()}export{$e as component};

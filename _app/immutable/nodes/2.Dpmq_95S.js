import{a as M,t as O}from"../chunks/disclose-version.CBDp_jRG.js";import{i as G}from"../chunks/legacy.BGFYsm5K.js";import{q as C,v as K,w as J,x as Q,y as W,z as Z,A as ee,B as Y,H as te,C as B,D as H,E as I,F as le,I as N,G as P,J as X,K as ae,L as $,M as ne,N as se,O as ie,P as re,Q as oe,R as ce,S as fe,T as z,U as ue,V as de,W as ve,X as pe,p as he,j as me,k as F,o as R,m as T,Y as ge,t as xe,g as j}from"../chunks/runtime.B70LyI_i.js";import{e as S,s as be}from"../chunks/render.aljE-O42.js";import{s as _e,i as ye,a as we}from"../chunks/store.m4PN_y94.js";import{w as ke}from"../chunks/index.BWrW99JZ.js";function Ee(o,e){return e}function Ae(o,e,t,c){for(var v=[],r=e.length,s=0;s<r;s++)se(e[s].e,v,!0);var m=r>0&&v.length===0&&t!==null;if(m){var p=t.parentNode;ie(p),p.append(t),c.clear(),k(o,e[0].prev,e[r-1].next)}re(v,()=>{for(var u=0;u<r;u++){var h=e[u];m||(c.delete(h.k),k(o,h.prev,h.next)),oe(h.e,!m)}})}function Te(o,e,t,c,v,r=null){var s=o,m={flags:e,items:new Map,first:null};{var p=o;s=C?K(J(p)):p.appendChild(Q())}C&&W();var u=null,h=!1;Z(()=>{var a=t(),d=ee(a)?a:a==null?[]:Y(a),n=d.length;if(h&&n===0)return;h=n===0;let i=!1;if(C){var x=s.data===te;x!==(n===0)&&(s=B(),K(s),H(!1),i=!0)}if(C){for(var w=null,b,l=0;l<n;l++){if(I.nodeType===8&&I.data===le){s=I,i=!0,H(!1);break}var f=d[l],y=c(f,l);b=q(I,m,w,null,f,y,l,v,e),m.items.set(y,b),w=b}n>0&&K(B())}if(!C){var g=ce;Ce(d,m,s,v,e,(g.f&N)!==0,c)}r!==null&&(n===0?u?P(u):u=X(()=>r(s)):u!==null&&ae(u,()=>{u=null})),i&&H(!0),t()}),C&&(s=I)}function Ce(o,e,t,c,v,r,s,m){var p=o.length,u=e.items,h=e.first,a=h,d,n=null,i=[],x=[],w,b,l,f;for(f=0;f<p;f+=1){if(w=o[f],b=s(w,f),l=u.get(b),l===void 0){var y=a?a.e.nodes_start:t;n=q(y,e,n,n===null?e.first:n.next,w,b,f,c,v),u.set(b,n),i=[],x=[],a=n.next;continue}if(Fe(l,w,f),l.e.f&N&&P(l.e),l!==a){if(d!==void 0&&d.has(l)){if(i.length<x.length){var g=x[0],_;n=g.prev;var D=i[0],E=i[i.length-1];for(_=0;_<i.length;_+=1)V(i[_],g,t);for(_=0;_<x.length;_+=1)d.delete(x[_]);k(e,D.prev,E.next),k(e,n,D),k(e,E,g),a=g,n=E,f-=1,i=[],x=[]}else d.delete(l),V(l,a,t),k(e,l.prev,l.next),k(e,l,n===null?e.first:n.next),k(e,n,l),n=l;continue}for(i=[],x=[];a!==null&&a.k!==b;)(r||!(a.e.f&N))&&(d??(d=new Set)).add(a),x.push(a),a=a.next;if(a===null)continue;l=a}i.push(l),n=l,a=l.next}if(a!==null||d!==void 0){for(var A=d===void 0?[]:Y(d);a!==null;)(r||!(a.e.f&N))&&A.push(a),a=a.next;var U=A.length;if(U>0){var L=p===0?t:null;Ae(e,A,L,u)}}$.first=e.first&&e.first.e,$.last=n&&n.e}function Fe(o,e,t,c){ne(o.v,e),o.i=t}function q(o,e,t,c,v,r,s,m,p,u){var h=(p&de)!==0,a=(p&ve)===0,d=h?a?fe(v):z(v):v,n=p&ue?z(s):s,i={i:n,v:d,k:r,a:null,e:null,prev:t,next:c};try{return i.e=X(()=>m(o,d,n),C),i.e.prev=t&&t.e,i.e.next=c&&c.e,t===null?e.first=i:(t.next=i,t.e.next=i.e),c!==null&&(c.prev=i,c.e.prev=i.e),i}finally{}}function V(o,e,t){for(var c=o.next?o.next.e.nodes_start:t,v=e?e.e.nodes_start:t,r=o.e.nodes_start;r!==c;){var s=pe(r);v.before(r),r=s}}function k(o,e,t){e===null?o.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Re(o){var v;const e=o.split("==========").map(r=>r.trim()).filter(Boolean),t={};for(const r of e){const s=r.split(`
`).map(n=>n.trim()).filter(Boolean);if(s.length<3)continue;const[m,,...p]=s,[u,h]=((v=m.match(/^(.*) \((.*)\)$/))==null?void 0:v.slice(1))||[m,"Unknown"],a=p.join(" "),d=u.replace(/_/g," ");t[d]||(t[d]={title:d,author:h,clippings:[]}),t[d].clippings.push(a)}const c={};for(const r of Object.values(t)){const{title:s,author:m,clippings:p}=r,u=[`# ${s}`,`**Author:** ${m}`,"",...p.map(h=>`- ${h}`)].join(`
`);c[`${s.replace(/[^a-zA-Z0-9а-яА-Я]/g,"_")}.md`]=u}return c}var Ie=O('<li class="flex items-center justify-between rounded-lg bg-gray-100 p-2 shadow"><span class="truncate"> </span> <button class="text-blue-600 hover:underline">Download</button></li>'),De=O('<ul class="space-y-2"></ul>'),Me=O('<p class="text-gray-500">No files parsed yet.</p>'),Ne=O('<main class="flex min-h-screen flex-col items-center bg-gray-50 p-4"><div class="flex max-w-[860px] flex-1 flex-col items-center"><section class="max-w-xl py-8"><div class="mx-auto max-w-3xl"><h2 class="mb-6 text-center text-3xl font-semibold text-gray-800">Kindle Notes to Markdown Converter</h2> <p class="mb-4 text-lg text-gray-600">Convert your Kindle highlights and notes into an organized Markdown file with ease. Simply\n					upload your `.txt` file containing your Kindle excerpts, and the tool will:</p> <ul class=" list-inside list-disc text-lg text-gray-700"><li>Extract the book title, author, and timestamps from each entry.</li> <li>Organize the notes by book, with a header for each title.</li> <li>Display the first and last highlight dates for each book.</li> <li>List all your Kindle highlights and notes in order.</li></ul></div></section> <div class="w-full max-w-xl rounded-lg bg-white p-4 shadow-lg"><label for="file-upload" class="mb-2 block text-sm font-medium text-gray-700">Upload Kindle My Clippings.txt Files</label> <input type="file" id="file-upload" multiple accept=".txt" class="block w-full cursor-pointer rounded-lg border border-gray-300 text-sm text-gray-900"> <button class="mt-4 w-full rounded-lg bg-blue-600 py-2 text-white hover:bg-blue-700">Parse Files</button></div> <div class="mt-8 w-full max-w-xl flex-1"><h2 class="mb-4 text-xl font-bold">Downloaded Files</h2> <!></div> <div class="mt-8 flex w-full max-w-md items-center justify-center"><a class="text-blue-600 hover:text-blue-700" href="https://chillyhill.me/">Denys Sych, 2025</a></div></div></main>');function Be(o,e){he(e,!1);const t=_e(),c=()=>we(r,"$parsedFiles",t);let v=[];const r=ke({});function s(l){const f=l.target;f.files&&(v=Array.from(f.files))}async function m(){for(const l of v){const f=await l.text(),y=Re(f);r.set(y)}}function p(l,f){const y=new Blob([f],{type:"text/markdown"}),g=document.createElement("a");g.href=URL.createObjectURL(y),g.download=l,g.click(),URL.revokeObjectURL(g.href)}G();var u=Ne(),h=F(u),a=R(F(h),2),d=R(F(a),2),n=R(d,2);T(a);var i=R(a,2),x=R(F(i),2);{var w=l=>{var f=De();Te(f,5,()=>Object.entries(c()),Ee,(y,g)=>{let _=()=>j(g)[0],D=()=>j(g)[1];var E=Ie(),A=F(E),U=F(A,!0);T(A);var L=R(A,2);T(E),xe(()=>be(U,_())),S("click",L,()=>p(_(),D())),M(y,E)}),T(f),M(l,f)},b=l=>{var f=Me();M(l,f)};ye(x,l=>{c()&&Object.keys(c()).length>0?l(w):l(b,!1)})}T(i),ge(2),T(h),T(u),S("change",d,s),S("click",n,m),M(o,u),me()}export{Be as component};
